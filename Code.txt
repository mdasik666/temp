from docx import Document
from docx.shared import RGBColor

def highlight_text_in_red(doc_path, target_word, output_path):
    doc = Document(doc_path)

    def process_text_runs(runs, target_word):
        """ Process each run in a paragraph or table cell """
        for run in runs:
            if target_word in run.text:
                run.font.color.rgb = RGBColor(255, 0, 0)  # Red color

    # Process paragraphs in the main document
    for para in doc.paragraphs:
        process_text_runs(para.runs, target_word)

    # Process tables in the document
    for table in doc.tables:
        for row in table.rows:
            for cell in row.cells:
                for para in cell.paragraphs:
                    process_text_runs(para.runs, target_word)

    # Process headers and footers
    for section in doc.sections:
        # Headers
        header = section.header
        for para in header.paragraphs:
            process_text_runs(para.runs, target_word)

        # Footers
        footer = section.footer
        for para in footer.paragraphs:
            process_text_runs(para.runs, target_word)

    # Save the modified document
    doc.save(output_path)

# Usage
doc_path = "input.docx"  # Input document
target_word = "example"  # Word to highlight
output_path = "output.docx"  # Output document

highlight_text_in_red(doc_path, target_word, output_path)
